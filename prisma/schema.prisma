
enum Status {
  PENDING
  COMPLETED
}
enum Visibility {
  VISIBLE
  HIDDEN
}

enum Pinned {
  PINNED
  UNPINNED
}

enum Role {
  SUPERADMIN
  ADMIN 
  USER
}

enum Priority {
  LOW
  MEDIUM
  HIGH
}

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User{
  id String @id @default(uuid())
  name String 
  email String @unique
  password String 
  notionToken String?
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  communities Community[]
  communityParticipant CommunityParticipants[]
  todos Todo[]
}

model Community{
  id String @id @default(uuid())
  name String 
  description String 
  logoUrl String? 
  websiteUrl String?
  createdBy String 
  visible Visibility @default(VISIBLE)
  user User @relation(fields: [createdBy], references: [id], onDelete: Cascade)
  subjects Subjects[]
  participants CommunityParticipants[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
model CommunityParticipants{
  id String @id @default(uuid())
  role Role @default(USER)

  communityId String 
  community Community @relation(fields: [communityId],references: [id],onDelete: Cascade)

  userId String
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Subjects{
  id String @id @default(uuid())
  communityId String 
  community Community @relation(fields:[communityId],references: [id],onDelete: Cascade)
  name String 
  description String?
  chapters Chapters[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Chapters {
  id String @id @default(uuid())
  subjectId String 
  subject Subjects @relation(fields: [subjectId],references: [id], onDelete: Cascade)
  name String
  notes Notes[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt 
}

model Notes {
  id String @id @default(uuid())
  title String 
  description String 
  documentLink String 
  ChaptersId String 
  summary SummarizedContent?
  chapters Chapters @relation(fields: [ChaptersId],references: [id],onDelete: Cascade)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Todo{
  id String @id @default(uuid())
  createdBy String 
  user User @relation(fields: [createdBy],references:[id],onDelete: Cascade)
  title String 
  description String 
  deadline DateTime
  pinned Pinned @default(UNPINNED)
  status Status @default(PENDING)
  visibility Visibility @default(VISIBLE)
  priority Priority @default(LOW)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model SummarizedContent {
  id String @id @default(uuid())
  notesId String @unique
  notes Notes @relation(fields:[notesId],references: [id],onDelete: Cascade)
  summary String
  quiz String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}